openapi: 3.0.3
info:
  title: AdoptMe API - Users (Swagger)
  version: 1.0.0
  description: |
    Documentación del módulo **Users** de AdoptMe.
    Autenticación por cookie JWT (`coderCookie`).
servers:
  - url: http://localhost:8080
    description: Local
tags:
  - name: Users
    description: Operaciones sobre usuarios
paths:
  /api/users:
    get:
      tags: [Users]
      summary: Listar usuarios
      operationId: listUsers
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  payload:
                    type: array
                    items:
                      $ref: "#/components/schemas/User"
        "500":
          $ref: "#/components/responses/InternalError"
  /api/users/{uid}:
    get:
      tags: [Users]
      summary: Obtener usuario por id
      operationId: getUserById
      parameters:
        - in: path
          name: uid
          required: true
          schema:
            type: string
          description: Mongo ObjectId
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  payload:
                    $ref: "#/components/schemas/User"
        "404":
          description: No encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                notFound:
                  value:
                    status: error
                    error: User not found
        "500":
          $ref: "#/components/responses/InternalError"
    put:
      tags: [Users]
      summary: Actualizar datos del usuario
      operationId: updateUser
      security:
        - cookieAuth: []
      parameters:
        - in: path
          name: uid
          required: true
          schema:
            type: string
          description: Mongo ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUserRequest"
      responses:
        "200":
          description: Actualizado
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: User updated
        "400":
          description: Parámetros inválidos
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: No encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                notFound:
                  value:
                    status: error
                    error: User not found
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalError"
    delete:
      tags: [Users]
      summary: Eliminar usuario
      operationId: deleteUser
      security:
        - cookieAuth: []
      parameters:
        - in: path
          name: uid
          required: true
          schema:
            type: string
          description: Mongo ObjectId
      responses:
        "200":
          description: Eliminado
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: User deleted
        "404":
          description: No encontrado
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalError"
components:
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: coderCookie
  responses:
    Unauthorized:
      description: No autorizado
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            unauth:
              value:
                status: error
                error: No auth token
    InternalError:
      description: Error del servidor
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            internal:
              value:
                status: error
                error: Internal server error
  schemas:
    ErrorResponse:
      type: object
      properties:
        status:
          type: string
          example: error
        error:
          type: string
          example: error message
    User:
      type: object
      properties:
        _id:
          type: string
          example: 64b1b7b2f1a2c3d4e5f6a7b8
        first_name:
          type: string
          example: John
        last_name:
          type: string
          example: Doe
        email:
          type: string
          format: email
          example: john@example.com
        role:
          type: string
          example: user
        pets:
          type: array
          items:
            type: string
            example: 64b1b7b2f1a2c3d4e5f6a7b8
    UpdateUserRequest:
      type: object
      properties:
        first_name:
          type: string
        last_name:
          type: string
        role:
          type: string
      additionalProperties: false
